(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,n){e.exports=n(57)},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var i=n(29),r=n(0),a=n.n(r),l=n(10),o=n(4),c=n(14),s=n(5),u=n(11),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_LIBRARY":return t.json;case"UPDATE_REFERENCE":return e.map(function(e){return e.id===t.id}).reduce(function(e,t){return e||t},!1)?e.map(function(e){return e.id===t.id?Object(u.a)({},t.newReferenceData):e}):[].concat(Object(s.a)(e),[t.newReferenceData]);default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER_TEXT":return t.filter;default:return e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,hasFailed:!1,hasFailedCitationStyleList:!1,hasFailedCitationLocale:!1,hrefRoot:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_LIBRARY":return Object.assign({},e,{isFetching:!0});case"RECEIVE_LIBRARY":return Object.assign({},e,{isFetching:!1});case"FAIL_RECEIVE_LIBRARY":return Object.assign({},e,{isFetching:!1,hasFailed:!0});case"RECEIVE_FILE_PATH_ROOT":return Object.assign({},e,{hrefRoot:t.path});case"FAIL_RECEIVE_CITATION_STYLE_LIST":return Object.assign({},e,{hasFailedCitationStyleList:!0});case"FAIL_RECEIVE_CITATION_LOCALE":return Object.assign({},e,{hasFailedCitationLocale:!0});default:return e}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isVisible:!1,refID:"",isFetchingLocale:!1,citationLocale:"",isFetchingStyle:!1,citationStyle:"",citationStyleName:"",citationStyleList:[],hasFailedCitation:!1,hasFailedCitationStyleList:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_CITATION":return Object.assign({},e,{isVisible:!0,refID:t.id});case"DISMISS_CITATION":return Object.assign({},e,{isVisible:!1,refID:""});case"REQUEST_CITATION_LOCALE":return Object.assign({},e,{isFetchingLocale:!0,citationLocale:null});case"RECEIVE_CITATION_LOCALE":return Object.assign({},e,{isFetchingLocale:!1,citationLocale:t.xml});case"REQUEST_CITATION_STYLE":return Object.assign({},e,{isFetchingStyle:!0,citationStyle:null,citationStyleName:"",hasFailedCitation:!1});case"RECEIVE_CITATION_STYLE":return Object.assign({},e,{isFetchingStyle:!1,citationStyle:t.xml,citationStyleName:t.styleName,hasFailedCitation:!1});case"RECEIVE_CITATION_STYLE_LIST":return Object.assign({},e,{citationStyleList:t.styleList,hasFailedCitationStyleList:!1});case"FAIL_RECEIVE_CITATION_STYLE_LIST":return Object.assign({},e,{hasFailedCitationStyleList:!0});case"FAIL_RECEIVE_CITATION_STYLE":return Object.assign({},e,{hasFailedCitation:!0});default:return e}},m=n(6),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isVisible:!1,refID:"",referenceEditing:null,isModified:!1,isShowingIDError:!1,hasFailedUpdatedReference:!1,fileList:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_EDIT_SCREEN":return Object.assign({},e,{isVisible:!0,refID:t.id,referenceEditing:Object.assign({},t.reference),isModified:!1,hasFailedUpdatedReference:!1});case"DISMISS_EDIT_SCREEN":return Object.assign({},e,{isVisible:!1,refID:"",referenceEditing:null,isModified:!1});case"FAIL_UPDATE_REFERENCE":return Object.assign({},e,{hasFailedUpdatedReference:!0});case"ID_ERROR_EDIT_SCREEN":return Object.assign({},e,{isShowingIDError:t.showError});case"EDIT_REFERENCE_FIELD":if(!e.referenceEditing)return e;var n=Object.assign({},e.referenceEditing,Object(m.a)({},t.key,t.value));return t.value&&""!==t.value||delete n[t.key],Object.assign({},e,{referenceEditing:n,isModified:e.isModified||!e.referenceEditing[t.key]||t.value!==e.referenceEditing[t.key]});case"EDIT_FILE_FIELD":if(!e.referenceEditing)return e;var i=e.referenceEditing[t.field].split(";").map(function(e,n){return n===t.index?t.value:e}).join(";");return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,i)),isModified:e.isModified||!e.referenceEditing[t.field]||e.referenceEditing[t.field]!==i});case"EDIT_NAME_FIELD":if(!e.referenceEditing)return e;var r=e.referenceEditing[t.field].map(function(e,n){return n===t.index?Object.assign({},e,Object(m.a)({},t.key,t.value)):e});return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,r)),isModified:e.isModified||!e.referenceEditing[t.field][t.index][t.key]||e.referenceEditing[t.field][t.index][t.key]!==t.value});case"ADD_NAME":if(!e.referenceEditing)return e;var a=e.referenceEditing[t.field]?[].concat(Object(s.a)(e.referenceEditing[t.field]),[{}]):[{}];return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,a))});case"ADD_FILE":if(!e.referenceEditing||""===t.file)return e;var l=e.referenceEditing[t.field]?e.referenceEditing[t.field].split(";"):[];return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,[].concat(Object(s.a)(l),[t.file]).join(";"))),isModified:!0});case"REMOVE_NAME":if(!e.referenceEditing)return e;var o=e.referenceEditing[t.field].filter(function(e,n){return n!==t.index});return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,o)),isModified:!0});case"REMOVE_FILE":if(!e.referenceEditing)return e;var c=e.referenceEditing[t.field].split(";").filter(function(e,n){return n!==t.index}).join(";");return Object.assign({},e,{referenceEditing:Object.assign({},e.referenceEditing,Object(m.a)({},t.field,c)),isModified:!0});case"RECEIVE_FILE_LIST":return Object.assign({},e,{fileList:t.json});default:return e}},g=Object(c.c)({library:h,references:f,visibilityFilter:d,citation:p,editReferenceScreen:E}),y=n(12),b=n.n(y),v=n(22);function _(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw a}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var S=n(45),N=0;function O(e){return function(t,n){return b()("http://localhost:5000/api/files?unlinked").then(function(e){return e.json()},function(e){throw new Error("Failed to file list"+e)}).then(function(e){t({type:"RECEIVE_FILE_LIST",json:e})},function(e){throw new Error("Failed to file list"+e)}).then(function(){var i=n().references.filter(function(t){return t.id===e})[0];t({type:"SHOW_EDIT_SCREEN",id:e,reference:i||{}})},function(e){console.log("Failed to file list",e)})}}function R(e){return{type:"ID_ERROR_EDIT_SCREEN",showError:e}}function T(e,t){return function(n){return b()("http://localhost:5000/api/library/"+encodeURIComponent(e),{method:"PUT",body:JSON.stringify(t)}).then(function(i){n(function(e,t){return{type:"UPDATE_REFERENCE",id:e,newReferenceData:t}}(e,t)),n({type:"DISMISS_EDIT_SCREEN"})},function(e){return n({type:"FAIL_UPDATE_REFERENCE"})})}}var C=function(e,t){return{type:"EDIT_REFERENCE_FIELD",key:e,value:t}},F=function(){return{type:"REQUEST_LIBRARY"}},j=function(e){return{type:"RECEIVE_LIBRARY",json:e}},L=function(){return{type:"FAIL_RECEIVE_LIBRARY"}};var A=function(){return{type:"FAIL_RECEIVE_CITATION_LOCALE"}},k=function(){return{type:"REQUEST_CITATION_LOCALE"}},w=function(e){return{type:"RECEIVE_CITATION_LOCALE",xml:e}};function D(e){return function(t){return t(M()),b()("http://localhost:5000/api/csl-styles/"+e).then(function(e){return e.text()},function(e){throw new Error("Error fetching citation style"+e)}).then(function(n){return t(V(n,e))},function(e){throw new Error("Error fetching citation style"+e)}).catch(function(e){console.log("Failed to receive citation style",e),t(x())})}}var x=function(){return{type:"FAIL_RECEIVE_CITATION_STYLE"}},M=function(){return{type:"REQUEST_CITATION_STYLE"}},V=function(e,t){return{type:"RECEIVE_CITATION_STYLE",xml:e,styleName:t}},B=function(e){return{type:"RECEIVE_FILE_PATH_ROOT",path:e}},U=n(16),P=n.n(U),Y=n(15),H=(n(18),n(54)),X={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",height:"300px"}},Q=function(e){var t=e.references,n=e.citation,i=e.dispatch;return a.a.createElement(P.a,{isOpen:n.isVisible,onAfterOpen:function(){},onRequestClose:function(){i({type:"DISMISS_CITATION"})},style:X,contentLabel:"Citation"},a.a.createElement("div",null,a.a.createElement("span",null,n.hasFailedCitation?a.a.createElement("div",{className:"Error"},"Failed to retrieve citation style."):a.a.createElement("div",null)),a.a.createElement("span",null,n.hasFailedCitationStyleList?a.a.createElement("div",{className:"Error"},"Failed to retreive citation style list."):a.a.createElement("div",null)),a.a.createElement(Y.a,{name:"cslStyle",value:n.citationStyleName,options:n.citationStyleList.map(function(e){return{value:e,label:e}}),onChange:function(e){return i(D(e.value))}})),a.a.createElement("div",null,function(e,t){if(void 0===t||void 0===t.refID||""===t.refID)return a.a.createElement("span",null,"No reference specified");if(t.isFetchingLocale)return a.a.createElement("span",null,"Fetching Citation Locale, please wait...");if(t.isFetchingStyle)return a.a.createElement("span",null,"Fetching Citation Style, please wait...");if(e.filter(function(e){return e.id===t.refID}).length<1)return a.a.createElement("span",null,"Reference not found");var n={retrieveLocale:function(e){return t.citationLocale},retrieveItem:function(t){return e.filter(function(e){return e.id===t})[0]}},i=new H.Engine(n,t.citationStyle),r=[];r.push(t.refID),i.updateItems(r);var l=i.makeBibliography();return a.a.createElement("span",{dangerouslySetInnerHTML:{__html:l[1]}})}(t,n)))},W=Q=Object(o.b)(function(e){return{references:e.references,citation:e.citation}})(Q),J=n(21),K=n.n(J),z=(n(55),[{field:"id",hint:"the identification of the reference (not part of CSL)"},{field:"type",type:"TYPE",hint:"the type of the reference (ie. article, book, etc.)"},{field:"number",hint:"number identifying the item (e.g. a report number)"},{field:"author",type:"NAME",hint:"author"},{field:"composer",type:"NAME",hint:"composer (e.g. of a musical score)"},{field:"director",type:"NAME",hint:"director (e.g. of a film)"},{field:"editor",type:"NAME",hint:"editor"},{field:"editorial-director",type:"NAME",hint:"managing editor (\u201cDirecteur de la Publication\u201d in French)"},{field:"illustrator",type:"NAME",hint:"illustrator (e.g. of a children\u2019s book)"},{field:"interviewer",type:"NAME",hint:"interviewer (e.g. of an interview)"},{field:"recipient",type:"NAME",hint:"recipient (e.g. of a letter)"},{field:"translator",type:"NAME",hint:"translator"},{field:"title",hint:"primary title of the item"},{field:"title-short",hint:"short/abbreviated form of \u201ctitle\u201d (also accessible through the \u201cshort\u201d form of the \u201ctitle\u201d variable)"},{field:"edition",hint:"(container) edition holding the item (e.g. \u201c3\u201d when citing a chapter in the third edition of a book)"},{field:"abstract",type:"TEXT_AREA",hint:"abstract of the item (e.g. the abstract of a journal article)"},{field:"annote",hint:"reader\u2019s notes about the item content"},{field:"note",hint:"(short) inline note giving additional item details (e.g. a concise summary or commentary)"},{field:"container-author",type:"NAME",hint:"author of the container holding the item (e.g. the book author for a book chapter)"},{field:"container-title",hint:"title of the container holding the item (e.g. the book title for a book chapter, the journal title for a journal article)"},{field:"container-title-short",hint:"short/abbreviated form of \u201ccontainer-title\u201d (also accessible through the \u201cshort\u201d form of the \u201ccontainer-title\u201d variable)"},{field:"container",type:"DATE",hint:"?"},{field:"volume",hint:"(container) volume holding the item (e.g. \u201c2\u201d when citing a chapter from book volume 2)"},{field:"issue",hint:"(container) issue holding the item (e.g. \u201c5\u201d when citing a journal article from journal volume 2, issue 5)"},{field:"section",hint:"container section holding the item (e.g. \u201cpolitics\u201d for a newspaper article)"},{field:"page",hint:"range of pages the item (e.g. a journal article) covers in a container (e.g. a journal issue)"},{field:"page-first",hint:"first page of the range of pages the item (e.g. a journal article) covers in a container (e.g. a journal issue)"},{field:"publisher",hint:"publisher"},{field:"publisher-place",hint:"geographic location of the publisher"},{field:"issued",type:"DATE",hint:"date the item was issued/published"},{field:"submitted",type:"DATE",hint:"date the item (e.g. a manuscript) has been submitted for publication"},{field:"chapter-number",hint:"chapter number"},{field:"collection-editor",type:"NAME",hint:"editor of the collection holding the item (e.g. the series editor for a book)"},{field:"collection-title",hint:"title of the collection holding the item (e.g. the series title for a book)"},{field:"collection-number",hint:"number identifying the collection holding the item (e.g. the series number for a book)"},{field:"accessed",type:"DATE",hint:"date the item has been accessed"},{field:"event",hint:"name of the related event (e.g. the conference name when citing a conference paper)"},{field:"event-place",hint:"geographic location of the related event (e.g. \u201cAmsterdam, the Netherlands\u201d)"},{field:"event-date",type:"DATE",hint:"date the related event took place"},{field:"genre",hint:"class, type or genre of the item (e.g. \u201cadventure\u201d for an adventure movie, \u201cPhD dissertation\u201d for a PhD thesis)"},{field:"authority",hint:"issuing or judicial authority (e.g. \u201cUSPTO\u201d for a patent, \u201cFairfax Circuit Court\u201d for a legal case)"},{field:"jurisdiction",hint:"geographic scope of relevance (e.g. \u201cUS\u201d for a US patent)"},{field:"original-author",type:"NAME",hint:"?"},{field:"original-title",hint:"title of the original version (e.g. \u201c\u0412\u043e\u0439\u043d\u0430 \u0438 \u043c\u0438\u0440\u201d, the untranslated Russian title of \u201cWar and Peace\u201d)"},{field:"original-date",type:"DATE",hint:"(issue) date of the original version"},{field:"original-publisher",hint:"original publisher, for items that have been republished by a different publisher"},{field:"original-publisher-place",hint:"geographic location of the original publisher (e.g. \u201cLondon, UK\u201d)"},{field:"references",hint:"resources related to the procedural history of a legal case"},{field:"status",hint:"publication) status of the item (e.g. \u201cforthcoming\u201d)"},{field:"version",hint:"version of the item (e.g. \u201c2.0.9\u201d for a software program)"},{field:"number-of-pages",hint:"total number of pages of the cited item"},{field:"number-of-volumes",hint:"total number of volumes, usable for citing multi-volume books and such"},{field:"reviewed-author",type:"NAME",hint:"author of the item reviewed by the current item"},{field:"reviewed-title",hint:"title of the item reviewed by the current item"},{field:"scale",hint:"scale of e.g. a map"},{field:"dimensions",hint:"physical (e.g. size) or temporal (e.g. running time) dimensions of the item"},{field:"archive",hint:"archive storing the item"},{field:"archive_location",hint:"storage location within an archive (e.g. a box and folder number)"},{field:"archive-place",hint:"geographic location of the archive"},{field:"source",hint:"from whence the item originates (e.g. a library catalog or database)"},{field:"locator",hint:"a cite-specific pinpointer within the item (e.g. a page number within a book, or a volume in a multi-volume work). Must be accompanied in the input data by a label indicating the locator type (see the Locators term list), which determines which term is rendered by cs:label when the \u201clocator\u201d variable is selected."},{field:"DOI",hint:"Digital Object Identifier (e.g. \u201c10.1128/AEM.02591-07\u201d)"},{field:"ISBN",hint:"International Standard Book Number"},{field:"ISSN",hint:"International Standard Serial Number"},{field:"PMCID",hint:"PubMed Central reference number"},{field:"PMID",hint:"PubMed reference number"},{field:"call-number",hint:"call number (to locate the item in a library)"},{field:"keyword",hint:"keyword(s) or tag(s) attached to the item"},{field:"medium",hint:"medium description (e.g. \u201cCD\u201d, \u201cDVD\u201d, etc.)"},{field:"URL",hint:"Uniform Resource Locator (e.g. \u201chttp://aem.asm.org/cgi/content/full/74/9/2766\u201d)"},{field:"file",type:"FILE",hint:"the file linked with this reference entity"}]),q=z,$=n(2),G=n(3),Z=n(8),ee=n(7),te=n(9),ne=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).state={isEditing:!1},n}return Object(te.a)(t,e),Object(G.a)(t,[{key:"checkEnter",value:function(e){"Enter"!==e.key||this.props.isTextArea?"Escape"===e.key&&this.cancel():this.save()}},{key:"edit",value:function(){this.setState({editing:!0})}},{key:"save",value:function(){var e=this.refs.newText.value;this.setState({editing:!1}),this.props.onEdit&&this.props.onEdit(this.props.field,e)}},{key:"cancel",value:function(){this.setState({editing:!1})}},{key:"renderNormal",value:function(){var e=this;return a.a.createElement("span",{onClick:function(){e.edit()}},this.props.value&&""!==this.props.value?this.props.value.toString().split("\n").map(function(e,t){return a.a.createElement("span",{key:t,className:"Editable-paragraph"},""===e?a.a.createElement("br",null):e)}):a.a.createElement("span",{className:"Editable-empty"},this.props.field))}},{key:"renderForm",value:function(){var e=this;return a.a.createElement("input",{ref:"newText",defaultValue:this.props.value,onBlur:function(){e.save()},onKeyDown:function(t){e.checkEnter(t)},autoFocus:!0,className:"Editable"})}},{key:"renderTextArea",value:function(){var e=this;return a.a.createElement("textarea",{ref:"newText",defaultValue:this.props.value,onBlur:function(){e.save()},onKeyDown:function(t){e.checkEnter(t)},autoFocus:!0,className:"Editable"})}},{key:"render",value:function(){return this.state.editing&&this.props.isTextArea?this.renderTextArea():this.state.editing?this.renderForm():this.renderNormal()}}]),t}(a.a.Component),ie=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).state={isEditing:!1,yyyy:n.get_date_part_from_props(n.props.value,0),mm:n.get_date_part_from_props(n.props.value,1),dd:n.get_date_part_from_props(n.props.value,2)},n}return Object(te.a)(t,e),Object(G.a)(t,[{key:"get_date_part_from_props",value:function(e,t){return e&&e["date-parts"]&&e["date-parts"][0]?e["date-parts"][0][t]:""}},{key:"renderNormal",value:function(){var e=this;if(!this.props.value||!this.props.value["date-parts"])return a.a.createElement("span",{className:"Editable-empty",onClick:function(){e.setState({isEditing:!0})}},"yyyy/mm/dd");var t=this.props.value["date-parts"][0];return a.a.createElement("span",{onClick:function(){e.setState({isEditing:!0})}},[t[0]?t[0]:"",t[1]?t[1]:"",t[2]?t[2]:""].filter(function(e){return""!==e}).join("/"))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.focusBlurTimeout)}},{key:"onBlurTimerHandler",value:function(){var e={};this.state.yyyy&&""!==this.state.yyyy&&(e["date-parts"]=e["date-parts"]?e["date-parts"]:[],e["date-parts"][0]=e["date-parts"][0]?e["date-parts"][0]:[],e["date-parts"][0][0]=this.state.yyyy),this.state.mm&&""!==this.state.mm&&(e["date-parts"]=e["date-parts"]?e["date-parts"]:[],e["date-parts"][0]=e["date-parts"][0]?e["date-parts"][0]:[],e["date-parts"][0][0]=e["date-parts"][0][0]&&""!==e["date-parts"][0][0]?e["date-parts"][0][0]:"1",e["date-parts"][0][1]=this.state.mm),this.state.dd&&""!==this.state.dd&&(e["date-parts"]=e["date-parts"]?e["date-parts"]:[],e["date-parts"][0]=e["date-parts"][0]?e["date-parts"][0]:[],e["date-parts"][0][0]=e["date-parts"][0][0]&&""!==e["date-parts"][0][0]?e["date-parts"][0][0]:"1",e["date-parts"][0][1]=e["date-parts"][0][1]&&""!==e["date-parts"][0][1]?e["date-parts"][0][1]:"1",e["date-parts"][0][2]=this.state.dd),this.props.onEdit&&this.props.onEdit(this.props.field,e),this.setState({isEditing:!1,yyyy:this.get_date_part_from_props(e,0),mm:this.get_date_part_from_props(e,1),dd:this.get_date_part_from_props(e,2)})}},{key:"onBlur",value:function(e){var t=this;e.persist(),clearTimeout(this.focusBlurTimeout),this.focusBlurTimeout=setTimeout(function(){return t.onBlurTimerHandler()},16)}},{key:"onFocus",value:function(){var e=this;clearTimeout(this.focusBlurTimeout),this.focusBlurTimeout=setTimeout(function(){e.setState({isEditing:!0})},16)}},{key:"renderForm",value:function(){var e=this;return a.a.createElement("span",null,a.a.createElement("input",{type:"text",className:"DateEdit-yyyy",name:"yyyy",value:this.state.yyyy,onBlur:function(t){return e.onBlur(t)},onFocus:function(t){return e.onFocus(t)},onChange:function(t){e.setState({yyyy:t.target.value})},autoFocus:"true"}),a.a.createElement("input",{type:"text",className:"DateEdit-xx",name:"mm",value:this.state.mm,onBlur:function(t){return e.onBlur(t)},onFocus:function(t){return e.onFocus(t)},onChange:function(t){e.setState({mm:t.target.value})}}),a.a.createElement("input",{type:"text",className:"DateEdit-xx",name:"dd",value:this.state.dd,onBlur:function(t){return e.onBlur(t)},onFocus:function(t){return e.onFocus(t)},onChange:function(t){e.setState({dd:t.target.value})}}))}},{key:"render",value:function(){return this.state.isEditing?this.renderForm():this.renderNormal()}}]),t}(a.a.Component),re=["given","dropping-particle","non-dropping-particle","family","literal"],ae=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).state={},n}return Object(te.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,this.props.nameList?this.props.nameList.map(function(t,n){return a.a.createElement("div",{key:n,className:"Name-list-row"},a.a.createElement("div",{className:"Name-editable-left"},re.map(function(i){return a.a.createElement("div",{key:i,className:"Name-field"},a.a.createElement(ne,{field:i,value:t[i],onEdit:function(t,i){e.props.onEditNameField(n,t,i)}}))})),a.a.createElement("div",{className:"Name-editable-right"},a.a.createElement("button",{type:"button",onClick:function(){e.props.onDeleteName(n)}},"X")))}):a.a.createElement("span",null),a.a.createElement("button",{type:"button",onClick:function(){return e.props.onAddName()}},"+"))}}]),t}(a.a.Component),le=Object(o.b)()(ae),oe={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",height:"300px",width:"350px"}},ce=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).state={isShowingFilePickerModal:!1,fileToAdd:""},n}return Object(te.a)(t,e),Object(G.a)(t,[{key:"closeModal",value:function(){this.setState(Object(u.a)({},this.state,{isShowingFilePickerModal:!1}))}},{key:"openModal",value:function(){this.setState(Object(u.a)({},this.state,{isShowingFilePickerModal:!0,fileToAdd:""}))}},{key:"fileLink",value:function(e,t){var n="",i=e.split(":");return n=3===i.length?this.props.hrefRoot+"/"+i[1]:i[0],a.a.createElement("a",{key:t,href:n,target:"_blank",rel:"noopener noreferrer"},"Open File",a.a.createElement("br",null))}},{key:"render",value:function(){var e=this,t=this.props.files?this.props.files.split(";"):[];return a.a.createElement("div",null,t?t.map(function(t,n){return a.a.createElement("div",{key:n,className:"Name-list-row"},a.a.createElement("div",{className:"Name-editable-left"},a.a.createElement(ne,{field:"file",value:t,onEdit:function(t,i){e.props.onEditFileField(n,i)}}),a.a.createElement("div",{className:"Name-editable-left-link"},e.fileLink(t,n))),a.a.createElement("div",{className:"Name-editable-right"},a.a.createElement("button",{type:"button",onClick:function(){e.props.onDeleteFile(n)}},"X")))}):a.a.createElement("span",null),a.a.createElement("button",{type:"button",onClick:function(){return e.openModal()}},"Add File"),a.a.createElement(P.a,{isOpen:this.state.isShowingFilePickerModal,onAfterOpen:function(){},onRequestClose:function(){e.setState(Object(u.a)({},e.state,{isShowingFilePickerModal:!1}))},style:oe,contentLabel:"Add File"},a.a.createElement("div",null,"Select file to add:"),a.a.createElement(Y.a,{name:"filePicker",value:this.state.fileToAdd,options:this.props.allowableFileList.map(function(e){return{value:[e.file_name,e.path,e.mime_type].join(":"),label:e.path}}).filter(function(t){return!e.props.files||0===e.props.files.split(";").filter(function(e){return t.value===e}).length}),onChange:function(t){e.setState(Object(u.a)({},e.state,{fileToAdd:t?t.value:""}))}}),a.a.createElement("div",null,a.a.createElement("button",{type:"button",onClick:function(){var t=e.state.fileToAdd;""!==t&&(e.props.onAddFile(t),e.closeModal())}},"Add"),a.a.createElement("button",{type:"button",onClick:function(){return e.closeModal()}},"Cancel"))))}}]),t}(a.a.Component),se=n(34),ue=q,fe=["article","article-magazine","article-newspaper","article-journal","bill","book","broadcast","chapter","dataset","entry","entry-dictionary","entry-encyclopedia","figure","graphic","interview","legislation","legal_case","manuscript","map","motion_picture","musical_score","pamphlet","paper-conference","patent","post","post-weblog","personal_communication","report","review","review-book","song","speech","thesis","treaty","webpage"],de=function(e,t,n){return e&&e.referenceEditing?ue.map(function(i){return a.a.createElement("div",{key:i.field,className:"Ref-list-item-expand-row"},a.a.createElement("div",{className:"Ref-list-item-expand-left","data-tip":i.hint},i.field),a.a.createElement("div",{className:"Ref-list-item-expand-right"},function(e,t,n,i,r){switch(i.type){case"TEXT_AREA":return a.a.createElement(ne,{value:t[i.field],field:i.field,isTextArea:!0,onEdit:function(e,t){r(C(e,t))}});case"NAME":return a.a.createElement(le,{field:i.field,nameList:t[i.field],isEditable:!0,onEditNameField:function(e,t,n){r(function(e,t,n,i){return{type:"EDIT_NAME_FIELD",field:e,index:t,key:n,value:i}}(i.field,e,t,n))},onAddName:function(){r(function(e){return{type:"ADD_NAME",field:e}}(i.field))},onDeleteName:function(e){r(function(e,t){return{type:"REMOVE_NAME",field:e,index:t}}(i.field,e))}});case"FILE":return a.a.createElement(ce,{files:t[i.field],onEditFileField:function(e,t){r(function(e,t,n){return{type:"EDIT_FILE_FIELD",field:e,index:t,value:n}}(i.field,e,t))},onDeleteFile:function(e){r(function(e,t){return{type:"REMOVE_FILE",field:e,index:t}}(i.field,e))},onAddFile:function(e){r(function(e,t){return{type:"ADD_FILE",field:e,file:t}}(i.field,e))},allowableFileList:e.fileList,hrefRoot:n.hrefRoot});case"DATE":return a.a.createElement(ie,{value:t[i.field],field:i.field,onEdit:function(e,t){r(C(e,t))}});case"TYPE":return a.a.createElement(Y.a,{name:"typePicker",value:t[i.field],options:fe.map(function(e){return{value:e,label:e}}),onChange:function(e){r(C(i.field,e?e.value:""))}});default:return a.a.createElement(ne,{value:t[i.field],field:i.field,isTextArea:!1,onEdit:function(e,t){r(C(e,t))}})}}(e,e.referenceEditing,t,i,n)))}):a.a.createElement("span",null,"No reference specified")},he=function(e){var t=e.editReferenceScreen,n=e.library,i=e.dispatch;return a.a.createElement("div",null,a.a.createElement(se.a,null),a.a.createElement("div",{className:"Screen-header"},a.a.createElement("div",{className:"Header-buttons"},a.a.createElement("button",{type:"button",onClick:function(){i(function(e,t){var n=t(),i=n.editReferenceScreen,r=n.references;if(i.isModified){var a=i.refID,l=i.referenceEditing.id,o=Object.keys(i.referenceEditing).filter(function(e){var t=i.referenceEditing[e];return""!==t&&!(t.constructor===Object&&0===Object.keys(t).length)&&!(t.constructor===Array&&0===t.length)}).reduce(function(e,t){return e[t]=i.referenceEditing[t],e},{});r.filter(function(e){return e.id!==a}).map(function(e){return e.id===l}).reduce(function(e,t){return e+t},0)>0||""===l.trim()?e(R(!0)):e(T(a,o))}else e({type:"DISMISS_EDIT_SCREEN"})})}},"Save"),a.a.createElement("button",{type:"button",onClick:function(){t.isModified?function(e){Object(J.confirmAlert)({title:"Edit Reference",message:"Are you sure you want to close without saving?",confirmLabel:"Close without saving",cancelLabel:"Continue editing",onConfirm:function(){e({type:"DISMISS_EDIT_SCREEN"})},onCancel:function(){}})}(i):i({type:"DISMISS_EDIT_SCREEN"})}},"Cancel"))),a.a.createElement("span",null,t.hasFailedUpdatedReference?a.a.createElement("div",{className:"Error"},"Failed to update reference on server"):a.a.createElement("span",null)),a.a.createElement("span",null,t.isShowingIDError?function(e){return a.a.createElement(K.a,{title:"Edit Reference",message:"You have entered an invalid ID or one that is assigned to another item. Please change it.",confirmLabel:"OK",cancelLabel:"",onConfirm:function(){e(R(!1))},onCancel:function(){}})}(i):a.a.createElement("span",null)),a.a.createElement("div",{className:"Ref-list-item"},de(t,n,i)))},pe=he=Object(o.b)(function(e){return{editReferenceScreen:e.editReferenceScreen,library:e.library}})(he),me=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(Z.a)(this,Object(ee.a)(t).call(this,e))).state={isExpanded:!1},n}return Object(te.a)(t,e),Object(G.a)(t,[{key:"doExpand",value:function(){this.setState({isExpanded:!this.state.isExpanded})}},{key:"onCitation",value:function(){(0,this.props.dispatch)({type:"SHOW_CITATION",id:this.props.reference.id})}},{key:"doEditModal",value:function(){(0,this.props.dispatch)(O(this.props.reference.id))}},{key:"show_date",value:function(e){if(!e["date-parts"])return a.a.createElement("span",null,"Malformed date");var t=e["date-parts"][0];return[t[0]?t[0]:"",t[1]?t[1]:"",t[2]?t[2]:""].filter(function(e){return""!==e}).join("/")}},{key:"show_name_list",value:function(e,t){var n=this;return e?e.map(function(e,i){return a.a.createElement("div",{key:i,className:"Name-list-row"},a.a.createElement("div",null,re.map(function(i){return a.a.createElement("div",{key:i,className:"Name-field"},e[i]?n.highlighted_text(e[i],t):a.a.createElement("span",null))})))}):""}},{key:"field_contents",value:function(e,t){var n=this;switch(e.type){case"NAME":return a.a.createElement("div",{key:e.field,className:"Ref-list-item-expand-row"},a.a.createElement("div",{className:"Ref-list-item-expand-left"},e.field),a.a.createElement("div",{className:"Ref-list-item-expand-right"},this.show_name_list(this.props.reference[e.field],t)));case"DATE":return a.a.createElement("div",{key:e.field,className:"Ref-list-item-expand-row"},a.a.createElement("div",{className:"Ref-list-item-expand-left"},e.field),a.a.createElement("div",{className:"Ref-list-item-expand-right"},this.highlighted_text(this.show_date(this.props.reference[e.field]),t)));case"FILE":return a.a.createElement("div",{key:e.field,className:"Ref-list-item-expand-row"},a.a.createElement("div",{className:"Ref-list-item-expand-left"},e.field),a.a.createElement("div",{className:"Ref-list-item-expand-right"},this.props.reference[e.field].split(";").map(function(e,t){var i="",r="",l=e.split(":");return 3===l.length?(i=l[0],r=n.props.hrefRoot+"/"+l[1]):(i=l[0],r=l[0]),a.a.createElement("a",{key:t,href:r,target:"_blank",rel:"noopener noreferrer"},i,a.a.createElement("br",null))})));default:return a.a.createElement("div",{key:e.field,className:"Ref-list-item-expand-row"},a.a.createElement("div",{className:"Ref-list-item-expand-left"},e.field),a.a.createElement("div",{className:"Ref-list-item-expand-right"},this.highlighted_text(this.props.reference[e.field],t)))}}},{key:"render_expanded",value:function(e){var t=this;return a.a.createElement("div",{className:"Ref-list-item"},z.filter(function(e){return!!t.props.reference[e.field]}).map(function(n){return t.field_contents(n,e)}),a.a.createElement("div",{className:"Ref-list-item-expand-all"},a.a.createElement("button",{type:"button",onClick:function(){t.doEditModal()}},"Edit"),a.a.createElement("button",{type:"button",onClick:function(){t.onCitation()}},"Citation"),a.a.createElement("button",{type:"button",onClick:function(){t.doExpand()}},"Collapse")))}},{key:"render_author_list_collapsed",value:function(){return this.props.reference.author?this.props.reference.author.map(function(e){return e.literal?e.literal:e.family?e["non-dropping-particle"]?e["non-dropping-particle"]+" "+e.family:e.family:""}).join(", "):""}},{key:"render_collapsed",value:function(e){var t=this;return a.a.createElement("div",{className:"Ref-list-item"},a.a.createElement("div",{className:"Ref-list-item-1"},a.a.createElement("span",{className:"Ref-list-item-1-row"},this.highlighted_text(this.render_author_list_collapsed(),e)),a.a.createElement("span",{className:"Ref-list-item-1-row"},this.props.reference.number?this.highlighted_text(this.props.reference.number,e):a.a.createElement("span",null))),a.a.createElement("div",{className:"Ref-list-item-2"},this.highlighted_text(this.props.reference.issued&&this.props.reference.issued["date-parts"]?this.props.reference.issued["date-parts"][0][0]:"",e)),a.a.createElement("div",{className:"Ref-list-item-3"},this.highlighted_text(this.props.reference.title,e)),a.a.createElement("div",{className:"Ref-list-item-4"},a.a.createElement("button",{type:"button",onClick:function(){t.onCitation()}},"Citation"),a.a.createElement("button",{type:"button",onClick:function(){t.doExpand()}},"Expand")))}},{key:"highlight_paragraph",value:function(e,t){return e.toString().split(t).map(function(e,n){return e.match(t)?a.a.createElement("span",{className:"Highlighted",key:n},e):e})}},{key:"highlighted_text",value:function(e,t){var n=this;return(e||"").toString().split("\n").map(function(e,i){return a.a.createElement("span",{key:i,className:"Ref-paragraph"},""===e?a.a.createElement("br",null):t?n.highlight_paragraph(e,t):e)})}},{key:"render",value:function(){var e=this.props.visibilityFilter.match(/\S+/g)||[],t=0===e.length?null:new RegExp("("+e.join("|")+")","i");return this.state.isExpanded?this.render_expanded(t):this.render_collapsed(t)}}]),t}(a.a.Component),Ee=Object(o.b)()(me),ge=function(e){var t=e.references,n=e.library,i=e.visibilityFilter;return a.a.createElement("span",null,a.a.createElement("span",null,n.hasFailed?a.a.createElement("div",{className:"Error"},"Failed to retrieve library. Is the backend server running?"):a.a.createElement("span",null)),a.a.createElement("span",null,n.hasFailedCitationStyleList?a.a.createElement("div",{className:"Error"},"Failed to retrieve citation style list."):a.a.createElement("span",null)),a.a.createElement("span",null,n.hasFailedCitationLocale?a.a.createElement("div",{className:"Error"},"Failed to retrieve citation locale."):a.a.createElement("span",null)),a.a.createElement("span",null,n.isFetching?a.a.createElement("div",null,"Retrieving Library..."):a.a.createElement("div",null,t.map(function(e){return a.a.createElement(Ee,{key:e.id,reference:e,hrefRoot:n.hrefRoot,visibilityFilter:i})}))))},ye=z,be=function(e,t){var n=t.toUpperCase().match(/\S+/g)||[];return e.filter(function(e){return n.map(function(t){return ye.map(function(n){if(!e[n.field])return!1;switch(n.type){case"NAME":return e[n.field].map(function(e){return Object.keys(e).map(function(n){return e[n].toString().toUpperCase().includes(t)}).reduce(function(e,t){return e||t},!1)}).reduce(function(e,t){return e||t},!1);case"DATE":return e[n.field]["date-parts"].toString().toUpperCase().includes(t);case"FILE":return!1;default:return e[n.field].toString().toUpperCase().includes(t)}}).reduce(function(e,t){return e||t},!1)}).reduce(function(e,t){return e&&t},!0)})},ve=Object(o.b)(function(e){return{references:be(e.references,e.visibilityFilter),library:e.library,visibilityFilter:e.visibilityFilter}},function(e,t){return{}})(ge),_e=function(e){e.library;var t=e.visibilityFilter,n=e.dispatch;return a.a.createElement("div",null,a.a.createElement("div",{className:"Screen-header"},a.a.createElement("div",{className:"Header-buttons"},a.a.createElement("button",{type:"button",id:"addReference",className:"input-field",onClick:function(){return n(function(e,t){for(var n=t().references;n.map(function(e){return e.id===N.toString()}).reduce(function(e,t){return e||t},!1);)++N;e(O(N))})}},"Add Reference"),a.a.createElement("label",{htmlFor:"addReference"},"Add Reference"),a.a.createElement("input",{id:"importBibLaTeX",type:"file",className:"input-field",onChange:function(e){e.preventDefault();var t=Object(s.a)(e.target.files);if(!(t.length<1)){var i=new FileReader;i.onload=function(e){var t;n((t=e.target.result,function(e,n){new Promise(function(e){e(t)}).then(function(e){return new v.a(e,{processUnexpected:!0,processUnknown:{collaborator:"l_name"}})}).then(function(e){return e.output}).then(function(e){var t=new v.b(e).output;return Object.keys(t).map(function(n){return Object.assign({},t[n],e[n]&&e[n].unexpected_fields&&e[n].unexpected_fields.file?{file:e[n].unexpected_fields.file}:{},e[n].entry_key?{id:e[n].entry_key}:{})})}).then(function(t){var i,r=function e(t,n){return t.map(function(e){return e.id===n.id}).reduce(function(e,t){return e||t},!1)?e(t,Object.assign({},n,{id:n.id+"1"})):Object.assign({},n)},a=_(t);try{for(a.s();!(i=a.n()).done;){var l=i.value,o=r(n().references,l);e(T(o.id,o))}}catch(c){a.e(c)}finally{a.f()}})}))},i.readAsText(t[0]),e.target.value=null}}}),a.a.createElement("label",{htmlFor:"importBibLaTeX"},"Import BibLaTeX"),a.a.createElement("button",{type:"button",id:"exportLibrary",className:"input-field",onClick:function(){return n(function(e,t){var n=t().references,i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"});S.saveAs(i,"MyLibrary.json"),e({type:"SAVE_REFERENCES"})})}},"Export Library"),a.a.createElement("label",{htmlFor:"exportLibrary"},"Export Library")),a.a.createElement("div",{className:"Search"},"Search:",a.a.createElement("input",{type:"text",title:"Search",size:"40",onChange:function(e){n({type:"SET_FILTER_TEXT",filter:e.target.value})},defaultValue:t}))),a.a.createElement(ve,null))},Ie=_e=Object(o.b)(function(e){return{library:e.library,visibilityFilter:e.visibilityFilter}})(_e),Se=function(e){var t=e.editReferenceScreen;return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"App-header"},a.a.createElement("h2",null,"bib-git")),a.a.createElement(W,null),t.isVisible?a.a.createElement(pe,null):a.a.createElement(Ie,null))},Ne=Se=Object(o.b)(function(e){return{editReferenceScreen:e.editReferenceScreen}})(Se),Oe=(n(56),Object(c.d)(g,Object(c.a)(i.a)));Oe.dispatch(function(e){return e(F()),b()("http://localhost:5000/api/library").then(function(e){return e.json()},function(e){throw new Error("Failed to receive library"+e)}).then(function(t){return e(j(t))},function(e){throw new Error("Failed to receive library"+e)}).catch(function(t){console.log("Error fetching library",t),e(L())})}),Oe.dispatch(function(e){return b()("http://localhost:5000/api/csl-styles").then(function(e){return e.json()},function(e){throw new Error("Error fetching citation style list"+e)}).then(function(t){return e(function(e){return{type:"RECEIVE_CITATION_STYLE_LIST",styleList:e}}(t))},function(e){throw new Error("Error fetching citation style list"+e)}).catch(function(t){console.log("Error fetching citation style list",t),e({type:"FAIL_RECEIVE_CITATION_STYLE_LIST"})})}),Oe.dispatch(function(e){return e(k()),b()("http://localhost:5000/api/csl-locales/locales-en-US").then(function(e){return e.text()},function(e){throw new Error("Error fetching CSL locale"+e)}).then(function(t){return e(w(t))},function(e){throw new Error("Error fetching CSL locale"+e)}).catch(function(t){console.log("Error fetching CSL locale"+t),e(A())})}),Oe.dispatch(D("ieee")),Oe.dispatch(function(e){return b()("http://localhost:5000/api/filepath").then(function(e){return e.text()}).then(function(t){return e(B(t))})}),Object(l.render)(a.a.createElement(o.a,{store:Oe},a.a.createElement(Ne,null)),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.1dbbd6a2.chunk.js.map